<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iterative-solver: iterative-solver</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">iterative-solver
   &#160;<span id="projectnumber">.</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">iterative-solver </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md____w_iterative_solver_iterative_solver_README"></a></p>
<p>[<img src="https://github.com/molpro/iterative-solver/actions/workflows/build-and-test/badge.svg" alt="example workflow" style="pointer-events: none;" class="inline"/>]</p>
<p><a href="https://github.com/molpro/iterative-solver/blob/master/LICENSE"><img src="https://img.shields.io/badge/license-MIT-green.svg" alt="license" style="pointer-events: none;" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md11"></a>
Overview</h1>
<p>Implements iterative solvers for linear and non-linear problems and distributed arrays for HPC. The solvers are specialised to work with specific data types, but are also templated on the container allowing for easy integration into existing software.</p>
<p>List of key features:</p><ul>
<li>Implements iterative solvers for eigenvalue problem, linear equations, optimisation (L-BFGS) and non-linear equations (DIIS)</li>
<li>Novel algorithms including P-space and D-space (see paper)</li>
<li>Structured to allow easy addition of new solvers or modification of the current ones without changes to the user's code</li>
<li>Templated on container for easy integration into existing programs<ul>
<li>User defined containers can be used without modification with the help of array handler abstraction</li>
</ul>
</li>
<li>Specialised for double and complex value types, so that all heavy numerical operations are only compiled once</li>
<li>Provides distributed arrays in memory and on disk for HPC</li>
<li>Contains Fortran and C wrappers</li>
</ul>
<h1><a class="anchor" id="autotoc_md12"></a>
Installation</h1>
<p>CMake is used to build the library and it can integrate easily with other CMake builds.</p>
<div class="fragment"><div class="line">include(FetchContent)</div>
<div class="line">FetchContent_Declare(</div>
<div class="line">        iterative-solver</div>
<div class="line">        GIT_REPOSITORY https://github.com/molpro/iterative-solver.git</div>
<div class="line">        GIT_TAG ${COMMIT_HASH_OR_TAG_VALUE})</div>
<div class="line">FetchContent_MakeAvailable(iterative-solver)</div>
<div class="line">target_link_libraries(${YOUR_LIBRARY_NAME} PUBLIC molpro::iterative-solver)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md13"></a>
Usage</h1>
<h2><a class="anchor" id="autotoc_md14"></a>
Interfaces</h2>
<p>There is a hierarchy of abstract classes defined in <code><a class="el" href="IterativeSolver_8h_source.html">molpro/linalg/itsolv/IterativeSolver.h</a></code> with <code>IterativeSolver</code> defining the interface for common functionality and <code>LinearEigensystem</code>, <code>LinearEquations</code>, <code>Optimize</code> and <code>NonLinearEquations</code> defining functions that are specific to each type of solver. They are provided to reduce header bloat in user's code.</p>
<p>Each type of solver has at least one implementation class, e.g. <code>LinearEigensystemDavidson</code> in <code><a class="el" href="LinearEigensystemDavidson_8h_source.html">molpro/linalg/itsolv/LinearEigensystemDavidson.h</a></code>, which implements the full interface. The library is designed to make it easy to add new iterative solvers, so there might be more than one implementation.</p>
<h2><a class="anchor" id="autotoc_md15"></a>
Example</h2>
<p>The simplest way to use the library is to call <code>solve()</code> and pass a function for getting the action of the matrix on parameter set. Here is an example of using <code>LinearEigensystem</code> with Davidson preconditioner,</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;molpro/linalg/itsolv/LinearEigensystem.h&gt;</span></div>
<div class="line"><span class="comment">// ...</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="classmolpro_1_1linalg_1_1itsolv_1_1LinearEigensystem.html">molpro::linalg::itsolv::LinearEigensystem</a>;</div>
<div class="line"><span class="keyword">using</span> R = std::vector&lt;double&gt;;</div>
<div class="line"><span class="keyword">using</span> Q = std::vector&lt;double&gt;;</div>
<div class="line">LinearEigensystemDavdison&lt;R, Q&gt; solver{};</div>
<div class="line"><span class="keyword">auto</span> [x, g] = get_initial_parameters_and_action();</div>
<div class="line">solver.set_preconditioner_davidson(get_diagonal_matrix_elements());</div>
<div class="line">solver.solve(x, g, user_specified_action_function);</div>
<div class="line"><span class="keywordflow">if</span> (!solver.converged()){</div>
<div class="line">    <span class="comment">// deal with the unconverged case</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassmolpro_1_1linalg_1_1itsolv_1_1LinearEigensystem_html"><div class="ttname"><a href="classmolpro_1_1linalg_1_1itsolv_1_1LinearEigensystem.html">molpro::linalg::itsolv::LinearEigensystem</a></div><div class="ttdoc">Interface for a specific iterative solver, it can add special member functions or variables.</div><div class="ttdef"><b>Definition:</b> IterativeSolver.h:366</div></div>
</div><!-- fragment --><p>More advanced users can copy and modify the code in <code>solve()</code> to tailor it for their own use, see implementation in <code><a class="el" href="IterativeSolverTemplate_8h_source.html">molpro/linalg/itsolv/IterativeSolverTemplate.h</a></code>.</p>
<h2><a class="anchor" id="autotoc_md16"></a>
Containers and array handlers</h2>
<p>In many programs there are special containers for storing the vectors and operating on them. This might be for efficiency reasons, e.g. exploiting symmetry of the problem, or for collecting metadata, e.g. memory usage and operation count. In either case, The code is templated on container types to ease adaptation.</p>
<p>To avoid the code-bloat of header only libraries all of the numerically intensive work is specialised for <code>double</code> and <code>std::complex&lt;double&gt;</code> types. This makes recompilation of IterativeSolver with different container types very fast.</p>
<p>There are 3 types of containers:</p>
<ul>
<li>R &mdash; working set container<ul>
<li>fast access to elements</li>
<li>used sparingly to preserve memory</li>
</ul>
</li>
<li>Q &mdash; slow container<ul>
<li>slow access to elements</li>
<li>used for most of the subspace</li>
<li>usually on disk where there is lots of storage space</li>
</ul>
</li>
<li>P &mdash; sparse container<ul>
<li>light-weight sparse container (e.g. <code>std::map&lt;size_t, double&gt;</code>)</li>
</ul>
</li>
</ul>
<p>IterativeSolver does not modify containers directly instead using ArrayHandler for all array related operations. This allows for only modest restrictions on containers:</p>
<ul>
<li>must have a move constructor</li>
<li>must have conforming element type (currently <code>double</code> and <code>std::complex&lt;double&gt;</code>, but this can be easily extended)</li>
</ul>
<p>ArrayHandler is an abstract class used by IterativeSolver to perform copy and linear algebra operations (<code>dot</code>, <code>axpy</code>). iterative-solver provides implementations for Iterable containers (e.g. <code>std::vector</code>), distributed containers (e.g. <code><a class="el" href="classmolpro_1_1linalg_1_1array_1_1DistrArray.html" title="Array distributed across many processes supporting remote-memory-access, access to process local buff...">molpro::linalg::array::DistrArray</a></code>), and mapped containers (e.g. <code>std::map</code>). However, some users might need/want to provide their own implementations.</p>
<h1><a class="anchor" id="autotoc_md17"></a>
Citing</h1>
<p>Any publications resulting from this work should cite relevant papers in CITE.txt</p>
<h1><a class="anchor" id="autotoc_md18"></a>
List of Contributors</h1>
<p>Peter Knowles</p>
<p>Marat Sibaev</p>
<p>Iakov Polyak</p>
<p>Rob Welch </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
